{"ast":null,"code":"import\"antd/es/card/style\";import _Card from\"antd/es/card\";import\"antd/es/icon/style\";import _Icon from\"antd/es/icon\";import _regeneratorRuntime from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import\"antd/es/list/style\";import _List from\"antd/es/list\";import React,{Component}from'react';import LinkButton from'../../components/link-button';import{BASE_IMG_URL}from'../../utils/constants';import{reqCategory}from'../../api/index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Item=_List.Item;//product的详情的子路由组件\nvar ProductDetail=/*#__PURE__*/function(_Component){_inherits(ProductDetail,_Component);var _super=_createSuper(ProductDetail);function ProductDetail(){var _this;_classCallCheck(this,ProductDetail);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={cName1:'',//一级分类名称\ncName2:''//二级分类名称\n};return _this;}_createClass(ProductDetail,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props$location$,pCategoryId,categoryId,result,cName1,results,_cName,cName2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://得到当前商品的父id 和自己id\n_this$props$location$=this.props.location.state.product,pCategoryId=_this$props$location$.pCategoryId,categoryId=_this$props$location$.categoryId;if(!(pCategoryId==='0')){_context.next=9;break;}_context.next=4;return reqCategory(categoryId);case 4:result=_context.sent;cName1=result.data.name;this.setState({cName1:cName1});_context.next=15;break;case 9:_context.next=11;return Promise.all([reqCategory(pCategoryId),reqCategory(categoryId)]);case 11:results=_context.sent;_cName=results[0].data.name;cName2=results[1].data.name;this.setState({cName1:_cName,cName2:cName2});case 15:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;var title=/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(LinkButton,{children:/*#__PURE__*/_jsx(_Icon,{type:\"arrow-left\",style:{marginRight:10,fontSize:20},onClick:function onClick(){_this2.props.history.goBack();}})}),/*#__PURE__*/_jsx(\"span\",{type:\"primary\",children:\"\\u5546\\u54C1\\u8BE6\\u60C5\"})]});//读取传递过来的state数据\nvar _this$props$location$2=this.props.location.state.product,name=_this$props$location$2.name,desc=_this$props$location$2.desc,price=_this$props$location$2.price,detail=_this$props$location$2.detail,imgs=_this$props$location$2.imgs;var _this$state=this.state,cName1=_this$state.cName1,cName2=_this$state.cName2;return/*#__PURE__*/_jsx(_Card,{title:title,className:\"product-detail\",children:/*#__PURE__*/_jsxs(_List,{children:[/*#__PURE__*/_jsxs(Item,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"left\",children:\"\\u5546\\u54C1\\u540D\\u79F0\\uFF1A\"}),/*#__PURE__*/_jsx(\"span\",{children:name})]}),/*#__PURE__*/_jsxs(Item,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"left\",children:\"\\u5546\\u54C1\\u63CF\\u8FF0\\uFF1A\"}),/*#__PURE__*/_jsxs(\"span\",{children:[desc,\" \"]})]}),/*#__PURE__*/_jsxs(Item,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"left\",children:\"\\u5546\\u54C1\\u4EF7\\u683C\\uFF1A\"}),/*#__PURE__*/_jsx(\"span\",{children:price})]}),/*#__PURE__*/_jsxs(Item,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"left\",children:\"\\u6240\\u5C5E\\u5206\\u7C7B\\uFF1A\"}),/*#__PURE__*/_jsxs(\"span\",{children:[cName1,\" \",cName2?'-->'+cName2:'',\" \"]})]}),/*#__PURE__*/_jsxs(Item,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"left\",children:\"\\u5546\\u54C1\\u56FE\\u7247\\uFF1A\"}),/*#__PURE__*/_jsx(\"span\",{children:imgs.map(function(item){return/*#__PURE__*/_jsx(\"img\",{src:BASE_IMG_URL+item,className:\"product-img\",alt:\"img\"},item);})})]}),/*#__PURE__*/_jsxs(Item,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"left\",children:\"\\u5546\\u54C1\\u8BE6\\u60C5\\uFF1A\"}),/*#__PURE__*/_jsx(\"span\",{dangerouslySetInnerHTML:{__html:detail}})]})]})});}}]);return ProductDetail;}(Component);export{ProductDetail as default};","map":{"version":3,"sources":["C:/Users/itryl/Desktop/React client/client/src/pages/products/detail.jsx"],"names":["React","Component","LinkButton","BASE_IMG_URL","reqCategory","Item","ProductDetail","state","cName1","cName2","props","location","product","pCategoryId","categoryId","result","data","name","setState","Promise","all","results","title","marginRight","fontSize","history","goBack","desc","price","detail","imgs","map","item","__html"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Card, Icon, List } from 'antd'\r\nimport LinkButton from '../../components/link-button'\r\nimport {BASE_IMG_URL} from '../../utils/constants'\r\nimport {reqCategory} from '../../api/index'\r\nconst Item = List.Item\r\n//product的详情的子路由组件\r\nexport default class ProductDetail extends Component {\r\n    state={\r\n        cName1:'', //一级分类名称\r\n        cName2:''  //二级分类名称\r\n    }\r\n  async  componentDidMount(){\r\n        //得到当前商品的父id 和自己id\r\n        const {pCategoryId,categoryId}=this.props.location.state.product\r\n        if(pCategoryId==='0'){ //一级分类下的商品\r\n            const result=  await reqCategory(categoryId)\r\n            const cName1=result.data.name\r\n            this.setState({cName1})\r\n        }  else{  //二级分类下的商品\r\n            //通过多个await方式效率偏低：后面一个请求是在前一个请求成功返回之后才执行\r\n            // const result1=await reqCategory(pCategoryId) //获取一级分类列表\r\n            // const result2=await reqCategory(categoryId)  //获取二级分类列表\r\n            // const cName1=result1.data.name\r\n            // const cName2=result2.data.name\r\n            // this.setState({cName1,cName2})\r\n\r\n            //一次性发送多个请求，只有都成功了，才正产给处理\r\n          const results=await  Promise.all([\r\n                reqCategory(pCategoryId),reqCategory(categoryId)\r\n            ])\r\n            const cName1=results[0].data.name\r\n            const cName2=results[1].data.name\r\n            this.setState({cName1,cName2})\r\n        }\r\n       \r\n    }\r\n    render() {\r\n        const title = (\r\n            <span>\r\n                <LinkButton>\r\n                    <Icon type='arrow-left' style={{ marginRight: 10, fontSize: 20 }}\r\n                        onClick={() => { this.props.history.goBack() }}></Icon>\r\n                </LinkButton>\r\n                <span type='primary'>商品详情</span>\r\n            </span>\r\n        )\r\n        //读取传递过来的state数据\r\n        const { name, desc, price, detail, imgs} = this.props.location.state.product\r\n        const {cName1,cName2}=this.state\r\n        return (\r\n            <Card title={title} className='product-detail'>\r\n                <List>\r\n                    <Item>\r\n                        <span className='left'>商品名称：</span>\r\n                        <span>{name}</span>\r\n                    </Item>\r\n                    <Item>\r\n                        <span className='left'>商品描述：</span>\r\n                        <span>{desc} </span>\r\n                    </Item>\r\n                    <Item>\r\n                        <span className='left'>商品价格：</span>\r\n                        <span>{price}</span>\r\n                    </Item>\r\n                    <Item>\r\n                        <span className='left'>所属分类：</span>\r\n                        <span>{cName1} {cName2 ? '-->'+cName2:''} </span>\r\n                    </Item>\r\n                    <Item>\r\n                        <span className='left'>商品图片：</span>\r\n                        <span>\r\n                            {\r\n                                imgs.map(item => (\r\n                                    <img\r\n                                        key={item}\r\n                                        src={BASE_IMG_URL + item}\r\n                                        className=\"product-img\"\r\n                                        alt=\"img\"\r\n                                    />\r\n                                ))\r\n                            }\r\n                        </span>\r\n                    </Item>\r\n                    <Item>\r\n                        <span className='left'>商品详情：</span>\r\n                        <span dangerouslySetInnerHTML={{ __html: detail }}>\r\n                        </span>\r\n                    </Item>\r\n                </List>\r\n            </Card>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}