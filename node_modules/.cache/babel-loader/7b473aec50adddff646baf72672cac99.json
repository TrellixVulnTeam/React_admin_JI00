{"ast":null,"code":"import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";import\"antd/es/upload/style\";import _Upload from\"antd/es/upload\";import\"antd/es/icon/style\";import _Icon from\"antd/es/icon\";import\"antd/es/message/style\";import _message from\"antd/es/message\";import _regeneratorRuntime from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/itryl/Desktop/React client/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{reqDeleteImg}from'../../api/index';import{BASE_IMG_URL}from'../../utils/constants';//用于图片上传的组件\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PicturesWall=/*#__PURE__*/function(_React$Component){_inherits(PicturesWall,_React$Component);var _super=_createSuper(PicturesWall);//接受默认修改的图片显示\nfunction PicturesWall(props){var _this;_classCallCheck(this,PicturesWall);_this=_super.call(this,props);_this.state={previewVisible:false,// 标识是否显示大图预览Modal\npreviewImage:'',// 大图的url\nfileList:[/*{\r\n        uid: '-1', // 每个file都有自己唯一的id\r\n        name: 'xxx.png', // 图片文件名\r\n        status: 'done', // 图片状态: done-已上传, uploading: 正在上传中, removed: 已删除\r\n        url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png', // 图片地址\r\n      },*/]};_this.handleCancel=function(){return _this.setState({previewVisible:false});};_this.handlePreview=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://显示指定file对应的大图\n_this.setState({previewImage:file.url||file.preview,previewVisible:true});case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.getImgs=function(){return _this.state.fileList.map(function(file){return file.name;});};_this.handleChange=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2){var file,fileList,result,_result$data,name,url,_result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:file=_ref2.file,fileList=_ref2.fileList;if(!(file.status==='done')){_context2.next=6;break;}result=file.response;if(result.status===0){_message.success('上传图片成功！');_result$data=result.data,name=_result$data.name,url=_result$data.url;file=fileList[fileList.length-1];file.name=name;file.url=url;}else{_message.error('上传图片失败');}_context2.next=11;break;case 6:if(!(file.status==='removed')){_context2.next=11;break;}_context2.next=9;return reqDeleteImg(file.name);case 9:_result=_context2.sent;if(_result.status===0){_message.success('删除图片成功！');}else{_message.error('删除图片失败！');}case 11:_this.setState({//在操作（上传/删除）过程中更新fileList状态\nfileList:fileList});case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}();var _fileList=[];//如果传入了img，就将这个img赋值给fileList图片数组\nvar imgs=_this.props.imgs;if(imgs&&imgs.length>0){_fileList=imgs.map(function(img,index){return{uid:-index,//每一个file都有一个唯一的id\nname:img,//图片文件名\nstatus:'done',url:BASE_IMG_URL+img};});}//初始化状态\n_this.state={previewVisible:false,//标识是否显示大图预览 Modal\npreviewImage:'',//大图的地址\nfileList:_fileList//所有已上传图片的数组\n};return _this;}//隐藏Modal\n_createClass(PicturesWall,[{key:\"render\",value:function render(){var _this$state=this.state,previewVisible=_this$state.previewVisible,previewImage=_this$state.previewImage,fileList=_this$state.fileList;var uploadButton=/*#__PURE__*/ //上传的按钮\n_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(_Icon,{type:\"plus\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Upload\"})]});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(_Upload,{action:\"/manage/img/upload\"//上传图片的接口地址\n,accept:\"image/*\"//指定上传的为任意类型的图片\n,listType:\"picture-card\"//上传列表的内建样式，支持三种基本样式 text, picture 和 picture-card\n,name:\"image\"//发到后台的文件参数名  请求参数名\n,fileList:fileList//所有已上传图片文件对象的数组\n,onPreview:this.handlePreview,onChange:this.handleChange,children:fileList.length>=8?null:uploadButton}),/*#__PURE__*/_jsx(_Modal,{visible:previewVisible,footer:null,onCancel:this.handleCancel,children:/*#__PURE__*/_jsx(\"img\",{alt:\"example\",style:{width:'100%'},src:previewImage})})]});}}]);return PicturesWall;}(React.Component);export{PicturesWall as default};","map":{"version":3,"sources":["C:/Users/itryl/Desktop/React client/client/src/pages/products/pictures-wall.jsx"],"names":["React","reqDeleteImg","BASE_IMG_URL","PicturesWall","props","state","previewVisible","previewImage","fileList","handleCancel","setState","handlePreview","file","url","preview","getImgs","map","name","handleChange","status","result","response","success","data","length","error","imgs","img","index","uid","uploadButton","width","Component"],"mappings":"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","sourcesContent":["import { Upload, Icon, Modal, message } from 'antd';\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport {reqDeleteImg} from '../../api/index'\r\nimport {BASE_IMG_URL} from '../../utils/constants'\r\n\r\n\r\n//用于图片上传的组件\r\nexport default class PicturesWall extends React.Component {\r\n  //接受默认修改的图片显示\r\n  static propTypes={\r\n    imgs:PropTypes.array\r\n  }\r\n  state = {\r\n    previewVisible: false, // 标识是否显示大图预览Modal\r\n    previewImage: '', // 大图的url\r\n    fileList: [\r\n      /*{\r\n        uid: '-1', // 每个file都有自己唯一的id\r\n        name: 'xxx.png', // 图片文件名\r\n        status: 'done', // 图片状态: done-已上传, uploading: 正在上传中, removed: 已删除\r\n        url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png', // 图片地址\r\n      },*/\r\n    ],\r\n  }\r\n  constructor(props){\r\n    super(props)\r\n    let fileList=[]\r\n    //如果传入了img，就将这个img赋值给fileList图片数组\r\n   const {imgs}=this.props\r\n   if(imgs&&imgs.length>0){\r\n      fileList=imgs.map((img,index)=>({\r\n        uid:-index,  //每一个file都有一个唯一的id\r\n        name:img, //图片文件名\r\n        status:'done',\r\n        url:BASE_IMG_URL+img\r\n      }))\r\n   }\r\n    //初始化状态\r\n    this.state={\r\n      previewVisible: false,  //标识是否显示大图预览 Modal\r\n      previewImage: '',    //大图的地址\r\n      fileList   //所有已上传图片的数组\r\n    }\r\n  }\r\n\r\n //隐藏Modal\r\n  handleCancel = () => this.setState({ previewVisible: false });  \r\n\r\n  handlePreview = async file => {\r\n      //显示指定file对应的大图\r\n \r\n\r\n    this.setState({\r\n      previewImage: file.url || file.preview,\r\n      previewVisible: true,\r\n    });\r\n  };\r\n  //获取所有已上传图片文件名的数组\r\n  getImgs=()=>{\r\n      return this.state.fileList.map(file=>file.name)\r\n  }\r\n\r\n  //fileList所有已上传图片文件对象的数组\r\n  //file 当前操作的图片文件（上传/删除）\r\n  handleChange = async({ file,fileList }) => {\r\n      //一旦上传成功，将当前上传的file的信息修正（name,url）\r\n      if(file.status==='done'){\r\n          const result=file.response \r\n          if(result.status===0){\r\n              message.success('上传图片成功！')\r\n              const {name,url}=result.data\r\n              file=fileList[fileList.length-1]\r\n              file.name=name\r\n              file.url=url\r\n          }else{\r\n              message.error('上传图片失败')\r\n          }\r\n      }else if(file.status==='removed'){  //删除图片完成\r\n         const result=await reqDeleteImg(file.name)\r\n         if(result.status===0){\r\n           message.success('删除图片成功！')\r\n         }else{\r\n           message.error('删除图片失败！')\r\n         }\r\n      }\r\n      this.setState({    //在操作（上传/删除）过程中更新fileList状态\r\n      fileList \r\n    })};\r\n\r\n  render() {\r\n    const { previewVisible, previewImage, fileList } = this.state; \r\n    const uploadButton = (   //上传的按钮\r\n      <div>\r\n        <Icon type=\"plus\" />\r\n        <div >Upload</div>\r\n      </div>\r\n    );\r\n    return (\r\n      <div>\r\n        <Upload\r\n          action=\"/manage/img/upload\"   //上传图片的接口地址\r\n          accept='image/*'  //指定上传的为任意类型的图片\r\n          listType=\"picture-card\"  //上传列表的内建样式，支持三种基本样式 text, picture 和 picture-card\r\n          name='image'            //发到后台的文件参数名  请求参数名\r\n          fileList={fileList}    //所有已上传图片文件对象的数组\r\n          onPreview={this.handlePreview}\r\n          onChange={this.handleChange}\r\n        >\r\n          {fileList.length >= 8 ? null : uploadButton}\r\n        </Upload>\r\n        <Modal visible={previewVisible} footer={null} onCancel={this.handleCancel}>\r\n          <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\r\n        </Modal>\r\n      </div>\r\n    )\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}